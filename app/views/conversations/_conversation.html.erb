<style>

ul{
  list-style: none;
  margin: 0;
  padding: 0;
}

ul li{
  display:inline-block;
  clear: both;
  padding: 20px;
  border-radius: 30px;
  margin-bottom: 2px;
  font-family: Helvetica, Arial, sans-serif;
}

.other{
  background: #eee;
  float: left;
}

.me{
  float: right;
  background: #0084ff;
  color: #fff;
}

.other + .me{
  border-bottom-right-radius: 5px;
}

.me + .me{
  border-top-right-radius: 5px;
  border-bottom-right-radius: 5px;
}

.me:last-of-type {
  border-bottom-right-radius: 30px;
}

</style>


<li>
  <div class="panel panel-default" data-conversation-id="<%= conversation.id %>">
    <div class="panel-heading">
      <%= link_to conversation.opposed_user(user).username, '', class: 'toggle-window' %>
      <%= link_to "x", close_conversation_path(conversation), class: "btn btn-default btn-xs pull-right", remote: true, method: :post %>
    </div>

    <div class="panel-body" style="display: none;">
      <div class="messages-list">
        <ul>
          <!-- <%= render 'conversations/conversation_content', messages: conversation.messages, user: user %> -->
          <% conversation.messages.each do |message| %>
            <% if message.user_id == current_user.id %>
              <ul>
                <li class="me"> 
                  <div class="<%= user.id == message.user_id ? 'message-sent' : 'message-received' %>">
                    <%= message.body %>
                  </div>
                </li>
              </ul>
            <% else %>
              <ul>
                <li class="other"> 
                  <div class="<%= user.id == message.user_id ? 'message-sent' : 'message-received' %>">
                    <%= message.body %>
                  </div>
                </li>
              </ul>
            <% end %>
          <% end %>
        </ul>
      </div>
      <form class="new_message">
        <input name="conversation_id" type="hidden" value="<%= conversation.id %>">
        <input name="user_id" type="hidden" value="<%= user.id %>">
        <textarea name="body" class="input" placeholder="Send a Message"></textarea>
        <input type="submit" class="button is-info" value="Send">
      </form>
    </div>
  </div>
</li>